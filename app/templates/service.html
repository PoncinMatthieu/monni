
{% extends "layout.html" %}

{% block body %}
<h1 class="page-header">
  {{ service.data.name }}
  <div class="btn-group">
    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
      <span class="glyphicon glyphicon-cog"></span>
    </button>
    <ul class="dropdown-menu">
      <li><a href="{{ url_for('routeViewServicesGetForm', sid=service.id) }}">Edit</a></li>
      <li><a href="{{ url_for('routeViewServicesDelete', sid=service.id) }}">Delete</a></li>
    </ul>
  </div>
</h1>


<div>
  <form class="form-inline" method="get" action="{{ url_for('routeViewServices', sid=service.id) }}" role="form">
    <div class="form-group">
      <label class="sr-only" for="findField">Find</label>
      <input name="find" type="text" class="form-control" id="findField" placeholder="{'type': 'test'}" value="{% if form != None and 'find' in form %}{{ form['find'] }}{% endif %}">
    </div>
    <div class="form-group">
      <label class="sr-only" for="findField">Group by</label>
      <input name="group" type="text" class="form-control" id="groupField" placeholder="group-by-field" value="{% if form != None and 'group' in form %}{{ form['group'] }}{% endif %}">
    </div>
    <button type="submit" class="btn btn-default">Filter</button>
  </form>
</div>

{%
  set nbEvents = events|length
%}

<div>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th class="col-md-1">Status</th>
          <th class="col-md-3">Time</th>
          <th class="col-md-6">Type</th>
          <th class="col-md-2">Action</th>
        </tr>
      </thead>
      <tbody>
	{% for event in events %}
        <tr>
          <td class="col-md-1">{% if canBeResolved == True %}<img src="{% if event.resolved == True %}{{ url_for('static', filename='img/status-green.png') }}{% else %}{{ url_for('static', filename='img/status-red.png') }}{% endif %}" alt="" />{% endif %}</td>
          <td class="col-md-3">{{ event.datas.time|safe }}</td>
          <td class="col-md-6"><a href="{{ url_for('routeViewServicesEvent', eid=event.id) }}">{{ event.type|safe }}</a></td>
	  <td class="col-md-2">
	    <a href="{{ url_for('routeViewServicesArchiveEvent', eid=event.id) + '?' + queryString }}">Archive</a>
	    <a href="{{ url_for('routeViewServicesDeleteEvent', eid=event.id) + '?' + queryString }}">Del</a>
	  </td>
        </tr>
	{% endfor %}
	{% if nbEvents > 0: %}
	<tr>
	  <td class="col-md-1">Total:</td>
	  <td class="col-md-3">{{ events|length }}</td>
	  <td class="col-md-6" />
	  <td class="col-md-2" >
	    <a href="{{ url_for('routeViewServicesArchiveEvents', sid=service.id) + '?' + queryString }}">Archive All</a>
	    <a href="{{ url_for('routeViewServicesDeleteEvents', sid=service.id) + '?' + queryString }}">Del All</a>
	  </td>
	</tr>
	{% else %}
	<tr>
	  <td class="col-md-12"><em>Unbelievable. No event here so far</em></td>
	</tr>
	{% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
